import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

public class Main {
  public static void main(String[] args) {
    // Read phone numbers from to.ext
    String[] toNumbers = readLines("/home/software/Desktop/to.ext");

    // Read outstanding balances from money.ext
    String[] balances = readLines("/home/software/Desktop/money.ext");

    // Create and write to final.ext
    try {
      FileWriter writer = new FileWriter("/home/software/Desktop/final.ext");

      for (int i = 0; i < toNumbers.length; i++) {
        String toNumber = toNumbers[i];
        String balance = balances[i];

        String message = "You have an outstanding balance of $ " + balance
            + " with Allergy Consultant Inc. To make a payment via Phone or if you have any questions, Please call us at 5613687006. Reply STOP to optout.";

        String curlCommand = "curl -X POST https://api.twilio.com/2010-04-01/Accounts/AC2a1d2545d7c4388bce7f8cebf8bb5641/Messages.json"
            + " --data-urlencode \"To=" + toNumber + "\""
            + " --data-urlencode \"From=+15613635561\""
            + " --data-urlencode \"Body=" + message + "\""
            + " -u \"AC2a1d2545d7c4388bce7f8cebf8bb5641:06c980d9b27e54e18952a05a611485bb\"";

        writer.write(curlCommand + "\n");
      }

      writer.close();
    } catch (IOException e) {
      e.printStackTrace();
    }
  }

  // Helper function to read lines from a file
  private static String[] readLines(String filename) {
    try {
      BufferedReader reader = new BufferedReader(new FileReader(filename));
      String line;
      int numLines = 0;

      // First pass: count lines
      while ((line = reader.readLine()) != null) {
        numLines++;
      }

      // Second pass: read lines into array
      String[] lines = new String[numLines];
      reader.close();
      reader = new BufferedReader(new FileReader(filename));
      for (int i = 0; i < numLines; i++) {
        lines[i] = reader.readLine().trim();
      }
      reader.close();

      return lines;
    } catch (IOException e) {
      e.printStackTrace();
      return null;
    }
  }
}
